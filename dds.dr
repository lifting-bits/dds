#prologue ```python
from capstone import CsInsn
```
;---------------------------------------------------------
;---------------------------------------------------------

; Section declarations
#message     section(bytes Name, u64 Start, u64 End)
#message dat_section(bytes Name, u64 Start, u64 End)
#message exe_section(bytes Name, u64 Start, u64 End)

;---------------------------------------------------------
;---------------------------------------------------------

; Get all section names
#query get_sec_names(free bytes Name)
get_sec_names(Name): section(Name,_,_).

; Get all section start addresses
#query get_sec_starts(free u64 Start)
get_sec_starts(Start): section(_,Start,_).

; Get all section end addresses 
#query get_sec_ends(free u64 End)
get_sec_ends(End): section(_,_,End).

;---------------------------------------------------------
;---------------------------------------------------------

; Instruction declarations
#foreign     instruction ```python CsInsn```
#message dec_instruction(bytes SecName, u64 Addr, instruction Insn)

; Given a section name, get all instruction addresses
#query get_sec_insns(bound bytes SecName, free u64 Addr)
get_sec_insns(SecName, Addr) :
  dec_instruction(SecName, Addr, _),
  section(SecName,_,_).

;---------------------------------------------------------


